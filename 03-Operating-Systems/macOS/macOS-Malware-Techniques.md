# macOS Malware Techniques â€” Behavior, Tradecraft & Detection (SOC / DFIR)



---

## Overview

macOS malware focuses on **stealth, trust abuse, and long-term access** rather than loud exploitation.

Most macOS malware:
- Runs in user space  
- Is signed or appears legitimate  
- Relies on built-in tools  
- Avoids kernel interaction  

Understanding **techniques**, not malware families, is critical for SOC detection.

---

## macOS Malware Design Philosophy

Attackers design macOS malware to:
- Look like normal applications  
- Blend into user workflows  
- Abuse Apple security features  
- Minimize EDR visibility  
- Persist quietly  

Key principle:
> If the user approves it, the system trusts it.

---

## Initial Execution Techniques

### 1. User-Assisted Execution

Most common entry point:
- User opens DMG / PKG  
- User launches app  
- User approves prompts  

No exploit required.

ðŸš© **SOC Signal:**  
Execution triggered by GUI apps instead of shells.

---

### 2. Script-Based Execution

Attackers prefer scripts over binaries:
- bash / zsh  
- osascript  
- python  
- perl  

Advantages:
- No compilation  
- Easy obfuscation  
- Trusted interpreters  

Example:
```
osascript â†’ curl â†’ execute script
```

---

## Living-off-the-Land (LOLBins)

macOS provides many powerful built-in tools.

Common LOLBins:
- osascript  
- launchctl  
- curl  
- bash / zsh  
- python  
- plutil  
- defaults  
- sqlite3  

**SOC Note:**  
Binary name alone is low signal â€” context is everything.

---

## Code Signing Abuse

### Signed Malware

Attackers use:
- Stolen developer certificates  
- Abused notarization  

Benefits:
- Gatekeeper bypass  
- User trust  
- Fewer alerts  

ðŸš© **Detection Focus:**
- Signed apps with abnormal child processes  
- Network activity from GUI apps  
- Excessive permission requests  

---

## Obfuscation Techniques

Common macOS malware obfuscation:
- Base64-encoded scripts  
- Encrypted strings  
- Obfuscated AppleScript  
- Dynamic command construction  
- Runtime decoding  

Example pattern:
```
echo <base64> | base64 -d | sh
```

---

## Credential Access Techniques

### 1. Keychain Abuse
- Access saved passwords  
- Target browser credentials  
- Steal Wi-Fi keys  

### 2. Browser Data Theft
- Cookies  
- Session tokens  
- Autofill data  

ðŸš© **SOC Indicators:**
- Unexpected Keychain API access  
- Browser processes accessing filesystem aggressively  

---

## Permission Abuse (TCC)

High-value permissions:
- Accessibility  
- Full Disk Access  
- Screen Recording  

Abuse methods:
- Social engineering prompts  
- Leveraging trusted apps  
- Retaining permissions for persistence  

ðŸš© **Permissions without binaries = stealth persistence.**

---

## Persistence-Centric Malware

macOS malware often prioritizes persistence first.

Techniques:
- LaunchAgents  
- Login Items  
- Configuration Profiles  
- Shell init files  

Payload execution may occur later.

---

## Defense Evasion Techniques

macOS malware evasion includes:
- Avoiding kernel activity  
- Blending into user directories  
- Using signed binaries  
- Limiting runtime  
- Delaying execution  

EDR blind spots are intentional targets.

---

## Command-and-Control (C2)

Common C2 traits:
- HTTPS over standard ports  
- Domain fronting  
- Cloud services (Dropbox, GitHub, Google)  

ðŸš© **SOC Detection:**
- GUI apps initiating outbound HTTPS  
- Rare domains contacted post-login  

---

## Anti-Analysis Techniques

- Environment checks  
- Delayed execution  
- Single-run payloads  
- Removal after execution  
- Dependency on user actions  

---

## Detection Strategies (Technique-Based)

Focus on:
- Parent-child anomalies  
- Permission grants followed by execution  
- launchd persistence creation  
- Script execution from GUI apps  
- Network activity from non-network software  

---

## Key Takeaways

- macOS malware is user-space and trust-based  
- Signed malware is more dangerous than unsigned  
- Permissions are a persistence mechanism  
- Scripts are preferred over binaries  
- Behavior > malware family names  

---
