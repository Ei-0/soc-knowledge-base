# Case 03 – ICMP Abuse (Reconnaissance & Covert Communication)

ICMP is designed for diagnostics, not data transfer.
Because it is often trusted or lightly filtered, attackers abuse ICMP for reconnaissance and covert communication.

This scenario demonstrates how a SOC analyst investigates suspicious ICMP activity.

---

## Detection Context
The SOC receives an alert indicating:
- Unusual ICMP volume from a single host
- Persistent ICMP echo requests
- ICMP traffic to external destinations

Alert source:
- IDS / SIEM anomaly detection rule

---

## Initial Alert Indicators
- Source host: Internal workstation
- Destination: Multiple internal hosts and one external IP
- Protocol: ICMP
- ICMP types: Echo Request / Echo Reply
- Frequency: High and sustained

---

## Step 1: Triage
SOC analyst actions:
- Identify the affected host and user
- Confirm ICMP activity exceeds normal baseline
- Determine whether activity is diagnostic or automated

Key question:
Why is this host generating continuous ICMP traffic?

---

## Step 2: ICMP Log & Traffic Analysis
Findings:
- ICMP requests sent sequentially across internal IP range
- ICMP traffic continues after successful replies
- Payload size larger than typical ping usage

Conclusion:
Activity does not match normal troubleshooting behavior.

---

## Step 3: Reconnaissance Detection
Indicators suggest:
- ICMP sweep for host discovery
- Network mapping prior to lateral movement

Additional findings:
- ICMP traffic observed shortly before other suspicious activity

---

## Step 4: Covert Communication Check
Further analysis reveals:
- Repetitive ICMP traffic to a single external IP
- Consistent payload structure
- Regular timing patterns

This raises suspicion of ICMP tunneling or covert C2.

---

## Step 5: Endpoint Correlation
EDR findings:
- ICMP traffic generated by a non-standard process
- Process not associated with network diagnostics
- Executable located in user directory

This confirms malicious intent.

---

## Step 6: Threat Validation
Indicators strongly suggest:
- Network reconnaissance via ICMP
- Potential covert command-and-control channel

MITRE ATT&CK Mapping:
- Discovery – Network Service Scanning
- Command and Control – ICMP

---

## Step 7: Containment
SOC response actions:
- Isolate the affected endpoint
- Block ICMP traffic from the host
- Terminate malicious process
- Preserve forensic evidence

---

## Step 8: Hunting & Scope Expansion
- Search for similar ICMP patterns across environment
- Identify other hosts performing ICMP sweeps
- Review historical ICMP logs
- Check for follow-on lateral movement activity

---

## Lessons Learned
- ICMP should be low-volume and short-lived
- Persistent ICMP activity is a strong anomaly
- Endpoint correlation is critical for confirmation

---

## Key Takeaway
ICMP is meant to be **quiet and brief**.
When it becomes persistent or patterned, it often signals malicious activity.
